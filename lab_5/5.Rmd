  ---
  title: "Лабораторна робота №5. Модель парної регресії"
  author: "Левченко Дмитро"
  output: html_notebook
  ---
  
### Завантаження даних та вибір змінних X, Y
  
  ```{r}
  library(readxl)
  vars <- read_excel("vars.xls")
  
  names(vars)
  
  X <- vars[[5]]   
  Y <- vars[[30]]
  
  length(X); length(Y)
  summary(X); summary(Y)
  ```
  
  ### Діаграма розсіювання та кореляція
  
  Спочатку дослідимо характер зв’язку між змінними $X$ та $Y$ за допомогою діаграми розсіювання та коефіцієнта кореляції Пірсона.\
  Діаграма розсіювання показує форму залежності, а коефіцієнт кореляції чисельно оцінює силу та напрямок лінійного зв’язку.
  
  ```{r scatter-cor}
  plot(X, Y,
       main = "Діаграма розсіювання для X та Y",
       xlab = "X = Col_13",
       ylab = "Y = Col_38",
       pch  = 19,
       col  = "darkblue")
  
  cor_xy <- cor(X, Y)
  cor_xy
  ```
  
  Отримане значення коефіцієнта кореляції $r \approx$ -0.7888836.\
  Якщо $r > 0$, то між змінними спостерігається прямий лінійний зв’язок: зі збільшенням $X$ значення $Y$ в середньому також зростає.\
  Якщо $|r|$ достатньо близьке до 1, зв’язок вважається сильним; якщо ж $|r|$ близьке до 0, лінійний зв’язок слабкий.
  
### Побудова моделі парної лінійної регресії
  
  Модель парної лінійної регресії описує залежність середнього значення $Y$ від змінної $X$ у вигляді рівняння: $$
  \hat{Y} = b_0 + b_1 X,
  $$ де $b_0$ – вільний член (перетин із віссю $Y$),\
  $b_1$ – коефіцієнт нахилу, що показує зміну $Y$ при збільшенні $X$ на одну одиницю.
  
  ```{r lm-model}
  model <- lm(Y ~ X)
  
  summary(model)
  ```
  
  За результатами оцінювання параметрів моделі одержано: $$
  \hat{Y} = b_0^\* + b_1^\* X,
  $$ де $b_0^\* \approx$ ***,*** $b_1^\* \approx$ 2.504.
  
  Коефіцієнт $b_1$ інтерпретується так: при збільшенні $X$ на 1 одиницю, середнє значення $Y$ змінюється приблизно на $b_1^\*$ одиниць.
  
  ------------------------------------------------------------------------
  
### Графік з лінією регресії
  
  Для наочного відображення моделі накладемо пряму регресії на діаграму розсіювання.\
  Це дозволить порівняти реальні спостереження з теоретичними значеннями, що прогнозуються моделлю.
  
  ```{r reg-line}
  plot(X, Y,
       main = "Парна лінійна регресія Y від X",
       xlab = "X = Col_5",
       ylab = "Y = Col_30",
       pch  = 19,
       col  = "darkblue")
  
  abline(model, col = "red", lwd = 2)
  
  ```
  
### Оцінка якості моделі (R², значущість)
  
У виводі `summary(model)` наведено також: - коефіцієнт детермінації $R^2$, який показує частку варіації $Y$, пояснену побудованою лінійною моделлю; - значення p-value для коефіцієнта $b_1$.
  
  Якщо $R^2$ достатньо велике, а p-value для $b_1$ менше за обраний рівень значущості (наприклад, $\alpha = 0{,}05$), то можна зробити висновок, що модель є статистично значущою, а змінна $X$ істотно впливає на $Y$.
  
  ------------------------------------------------------------------------
  
  ### Висновки
  
За діаграмою розсіювання та коефіцієнтом кореляції встановлено наявність досить сильного оберненого лінійного розв’язку.
  
За методом найменших квадратів побудовано модель парної лінійної регресії $$
\hat{Y} = b_0^\* + b_1^\* X,
$$ параметри якої є статистично значущими (за результатами перевірки p-value).\
Значення коефіцієнта детермінації $R^2 \approx$ 0.62 свідчить про те, що модель пояснює приблизно 62% варіації результативної змінної $Y$.
  
Отже, побудована лінійна модель може бути використана для приблизного прогнозування значень $Y$ за відомими значеннями $X$ у межах досліджуваного діапазону даних.
  
### Контрольні питання
  
## 1. Що таке точкова та інтервальна оцінка параметра розподілу?

**Точкова оцінка** — це одне числове значення, яке використовується для наближеного оцінювання невідомого параметра генеральної сукупності (наприклад, середнього значення, дисперсії тощо) за вибірковими даними.

**Інтервальна оцінка** — це інтервал значень, який з певною довірчою ймовірністю містить істинне значення параметра розподілу. Така оцінка дозволяє врахувати випадкові похибки вибірки.

---

## 2. Які оцінки називаються незсуненими, обґрунтованими та ефективними?

- **Незсунена оцінка** — це така оцінка, математичне сподівання якої дорівнює істинному значенню параметра.

- **Обґрунтована (сумісна) оцінка** — це оцінка, яка при збільшенні обсягу вибірки збігається за ймовірністю до істинного значення параметра.

- **Ефективна оцінка** — це незсунена оцінка, що має найменшу можливу дисперсію серед усіх незсунених оцінок.

---

## 3. Чому точні вибіркові розподіли називаються точними?

Точні вибіркові розподіли називаються точними тому, що вони отримані **без використання наближень** і базуються на строгих математичних формулах, які точно описують закон розподілу вибіркових статистик.

---

## 4. Надайте визначення квантиля розподілу. У чому сенс п’ятиквантильного графіка?

**Квантиль розподілу** — це таке значення випадкової величини, нижче якого знаходиться задана частка спостережень.

**П’ятиквантильний графік** ділить вибірку на п’ять рівних за кількістю частин і дозволяє наочно оцінити:
- форму розподілу,
- асиметрію,
- наявність викидів.

---

## 5. Які критерії називаються робастними?

**Робастними** називаються статистичні критерії, які **мало чутливі до викидів, шуму та відхилень від нормального розподілу**.  
Вони забезпечують надійні результати навіть при порушенні класичних припущень.
  
  ------------------------------------------------------------------------
