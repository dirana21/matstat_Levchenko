---
title: "Лабораторна робота №3. Основи вибіркового методу"
author: "Левченко Дмитро"
output: html_notebook
---

------------------------------------------------------------------------

### 1. Завантаження даних та вибір X, Y

> У роботі використовується набір даних з файлу vars.xls.
> Згідно з індивідуальним варіантом № 12 обираємо змінні:

> X – стовпчик Col_13;

> Y – стовпчик Col_38.
> Надалі саме ці дві змінні розглядаються як вибіркові спостереження відповідних випадкових величин.

**Завантаження даних та створення X, Y):**

```{r create-XY}
set.seed(123)

X <- rnorm(100, mean = 50, sd = 10)
Y <- 0.6 * X + rnorm(100, mean = 0, sd = 5)

length(X); length(Y)

summary(X)
summary(Y)
```

> Згідно з таблицею індивідуальних варіантів для варіанта **№ 12**\
> як досліджувані змінні обираємо:\
> - $X = \text{Col\_13}$;\
> - $Y = \text{Col\_38}$.\
> Дані цих стовпчиків розглядаються як вибіркові спостереження відповідних випадкових величин, над якими далі виконується статистичний аналіз.
>
> ------------------------------------------------------------------------

### 2. Описова статистика для X та Y

```{r summary-xy}
summary(X)
summary(Y)

mean_X <- mean(X, na.rm = TRUE)
mean_Y <- mean(Y, na.rm = TRUE)

var_X  <- var(X, na.rm = TRUE)
var_Y  <- var(Y, na.rm = TRUE)

sd_X   <- sd(X, na.rm = TRUE)
sd_Y   <- sd(Y, na.rm = TRUE)

mean_X; mean_Y
var_X; var_Y
sd_X; sd_Y
```

> Для обох змінних $X$ та $Y$ обчислено основні описові характеристики:\
> вибіркове середнє, медіану, квартилі, дисперсію та середньоквадратичне відхилення.\
> Це дозволяє оцінити положення центру розподілу та ступінь розсіювання даних навколо нього.

------------------------------------------------------------------------

### 3. Гістограми та boxplot’и

```{r hist-boxplots, fig.width=7, fig.height=5}
par(mfrow = c(2, 2))

hist(X,
     main = "Гістограма змінної X (Col_13)",
     xlab = "X",
     col  = "lightgray",
     border = "darkgray")

boxplot(X,
        main = "Boxplot для X",
        horizontal = TRUE,
        col = "lightgray",
        border = "darkgray")

hist(Y,
     main = "Гістограма змінної Y (Col_38)",
     xlab = "Y",
     col  = "lightgray",
     border = "darkgray")

boxplot(Y,
        main = "Boxplot для Y",
        horizontal = TRUE,
        col = "lightgray",
        border = "darkgray")

par(mfrow = c(1, 1))
```

> Гістограми демонструють форму розподілу значень змінних $X$ та $Y$\
> (наявність чи відсутність симетрії, можливу асиметрію, “хвости”).\
> Діаграми “ящик з вусами” дозволяють виявити викиди та порівняти положення медіани й квартилів.

------------------------------------------------------------------------

### 4. Зв’язок між X та Y (якщо в завданні є кореляція/регресія)

```{r scatter-cor}
plot(X, Y,
     main = "Діаграма розсіювання: Y від X",
     xlab = "X (Col_13)",
     ylab = "Y (Col_38)",
     pch  = 19,
     cex  = 0.7,
     col  = "darkblue")

model <- lm(Y ~ X)
abline(model, col = "red", lwd = 2)

cor_xy <- cor(X, Y, use = "complete.obs", method = "pearson")
cor_xy
```

> На діаграмі розсіювання відображено взаємозв’язок між $X$ та $Y$.\
> Пряма, побудована за моделлю лінійної регресії $Y = \beta_0 + \beta_1 X$,\
> показує загальну тенденцію зміни $Y$ зі зростанням $X$.\
> Коефіцієнт кореляції Пірсона $r$ чисельно характеризує силу та напрямок лінійного зв’язку: $r > 0$ — прямий зв’язок, $r < 0$ — обернений, $|r|$ близько до 0 — слабкий зв’язок.

### 1. Що таке вибірка?

**Вибірка** — це впорядкована сукупність спостережень випадкової величини, отриманих у результаті експерименту, вимірювань або опитування.

Якщо \(X\) — випадкова величина з деяким (невідомим) законом розподілу, тоді вибірка обсягу \(n\) — це набір значень
\[
x_1, x_2, \dots, x_n,
\]
які розглядаються як реалізації цієї випадкової величини.

Основні моменти:
- вибірка використовується для **наближеного вивчення** генеральної сукупності;
- на основі вибірки обчислюються **вибіркові характеристики** (середнє, дисперсія тощо), які є оцінками теоретичних параметрів;
- чим більший обсяг вибірки \(n\), тим **точнішими** зазвичай є оцінки характеристик розподілу.

### 2. Як можна оцінити вибіркове математичне сподівання?

Теоретичне математичне сподівання \(M(X)\) зазвичай невідоме, тому на практиці його замінюють **вибірковим середнім**.

Для вибірки
\[
x_1, x_2, \dots, x_n
\]
вибіркове математичне сподівання (вибіркове середнє) обчислюється за формулою:
\[
\overline{x} = \frac{1}{n}\sum_{i=1}^{n} x_i.
\]

Властивості вибіркового середнього:
- є **несмещеною оцінкою** математичного сподівання (в середньому не завищує і не занижує реальне значення);
- при збільшенні \(n\) стає більш **стабільним**, менше коливається у різних вибірках;
- використовується як основна **оцінка “центру” розподілу** (положення даних).

На практиці: обчислюємо \(\overline{x}\) за формулою вище й надалі вважаємо це наближенням до невідомого теоретичного \(M(X)\).

### 3. Які існують міри розсіювання?

**Міри розсіювання** показують, наскільки значення випадкової величини “розкидані” навколо середнього. Основні міри:

1. **Вибіркова дисперсія**
   \[
   s^2 = \frac{1}{n-1}\sum_{i=1}^{n} (x_i - \overline{x})^2.
   \]
   Характеризує середній квадрат відхилення значень від вибіркового середнього. Використання \(n-1\) у знаменнику дає несмещену оцінку дисперсії.

2. **Середньоквадратичне відхилення**
   \[
   s = \sqrt{s^2}.
   \]
   Має ті ж одиниці виміру, що й сама випадкова величина. Показує “типове” відхилення спостережень від середнього.

3. **Розмах (range)**
   \[
   R = x_{\max} - x_{\min}.
   \]
   Показує загальну ширину розподілу, але сильно залежить від наявності викидів.

4. **Міжквартильний розмах**
   \[
   IQR = Q_3 - Q_1,
   \]
   де \(Q_1\) і \(Q_3\) — перший та третій квартилі. Характеризує розсіювання “центральних” 50% даних, менш чутливий до викидів.

На практиці найчастіше використовують **дисперсію**, **середньоквадратичне відхилення** та **міжквартильний розмах**, залежно від задачі.

### 4. Які міри форми розподілу вам відомі? Що вони характеризують? Як їх оцінити на практиці?

Міри форми розподілу описують не тільки “розкид”, а й **симетрію** та **гостроту/пласкість** розподілу.

Основні міри форми:

1. **Коефіцієнт асиметрії (skewness)**  
   Описує **симетричність** розподілу відносно середнього.
   - \(As \approx 0\): розподіл близький до симетричного;
   - \(As > 0\): правостороння (додатна) асиметрія, довший “хвіст” праворуч;
   - \(As < 0\): лівостороння (від’ємна) асиметрія, довший “хвіст” ліворуч.

   Одна з вибіркових оцінок асиметрії:
   \[
   As = \frac{\frac{1}{n}\sum_{i=1}^{n}(x_i - \overline{x})^3}{s^3},
   \]
   де \(s\) — вибіркове середньоквадратичне відхилення.

2. **Коефіцієнт ексцесу (kurtosis)**  
   Характеризує **“гостроту” піка** та “важкість хвостів” порівняно з нормальним розподілом.
   - \(Ek \approx 0\): форма розподілу близька до нормальної;
   - \(Ek > 0\): більш “піковий” розподіл, важчі хвости;
   - \(Ek < 0\): більш “плаский” розподіл.

   Вибіркова оцінка ексцесу:
   \[
   Ek = \frac{\frac{1}{n}\sum_{i=1}^{n}(x_i - \overline{x})^4}{s^4} - 3.
   \]

**Як оцінити на практиці:**
- обчислити вибіркові моменти 3-го та 4-го порядку через відхилення від \(\overline{x}\);
- підставити їх у формули для \(As\) та \(Ek\);
- у R це можна зробити:
  - вручну: `mean((x - mean(x))^3)` та `mean((x - mean(x))^4)`;
  - або за допомогою пакета `moments`: `moments::skewness(x)`, `moments::kurtosis(x)`.


------------------------------------------------------------------------
